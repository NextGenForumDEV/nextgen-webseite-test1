<!DOCTYPE html>
<html class="light" lang="de">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Jetzt bewerben | NextGen Insurance Forum e.V.</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <meta name="description"
        content="Bewirb dich jetzt für das NextGen Insurance Forum. Starte deine Karriere in der Versicherungswirtschaft mit exklusiven Events und unserem Semesterprogramm." />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&amp;display=swap" rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap"
        rel="stylesheet" />
    <link href="./src/styles/global.css" rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#0E4B94",
                        "secondary": "#2CD9C3",
                        "background-light": "#FFFFFF",
                        "background-dark": "#111121",
                    },
                    fontFamily: {
                        "display": ["Manrope", "sans-serif"]
                    },
                },
            },
        }
    </script>
    <script src="src/js/cookie-consent.js" defer></script>
</head>

<body class="font-display bg-background-light dark:bg-background-dark text-[#0e0e1b] dark:text-gray-200">
    <div class="relative flex min-h-screen w-full flex-col">
        <header id="main-header"
            class="fixed top-0 z-50 w-full glass-header transition-all duration-300 bg-white/90 backdrop-blur-md shadow-sm dark:bg-background-dark/90">
            <div class="container mx-auto px-4">
                <div class="flex h-20 items-center justify-between max-w-6xl mx-auto">
                    <div class="flex items-center gap-4">
                        <a href="index.html" class="flex items-center">
                            <img src="./src/images/logo.png" alt="NextGen Logo" class="h-14 w-auto object-contain" />
                        </a>
                    </div>
                    <nav class="hidden items-center gap-8 text-sm font-medium lg:flex">
                        <a class="nav-link" href="studierende.html">Für Studierende</a>
                        <a class="nav-link" href="unternehmen.html">Für Unternehmen</a>
                        <a class="nav-link" href="veranstaltungen.html">Veranstaltungen</a>
                        <a class="nav-link" href="uber-uns.html">Über uns</a>
                        <a class="nav-link" href="kontakt.html">Kontakt</a>
                    </nav>
                    <button class="lg:hidden p-2 text-gray-600 dark:text-gray-300"
                        onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                </div>
            </div>
            <div id="mobile-menu"
                class="hidden lg:hidden absolute top-20 left-0 w-full bg-white dark:bg-[#111121] border-b border-gray-200 dark:border-gray-800 shadow-lg">
                <div class="flex flex-col p-4 space-y-4">
                    <a class="text-gray-700 dark:text-gray-300 hover:text-[#0E4B94] dark:hover:text-[#2CD9C3]"
                        href="studierende.html">Für Studierende</a>
                    <a class="text-gray-700 dark:text-gray-300 hover:text-[#0E4B94] dark:hover:text-[#2CD9C3]"
                        href="unternehmen.html">Für Unternehmen</a>
                    <a class="text-gray-700 dark:text-gray-300 hover:text-[#0E4B94] dark:hover:text-[#2CD9C3]"
                        href="veranstaltungen.html">Veranstaltungen</a>
                    <a class="text-gray-700 dark:text-gray-300 hover:text-[#0E4B94] dark:hover:text-[#2CD9C3]"
                        href="uber-uns.html">Über uns</a>
                    <a class="text-gray-700 dark:text-gray-300 hover:text-[#0E4B94] dark:hover:text-[#2CD9C3]"
                        href="kontakt.html">Kontakt</a>
                </div>
            </div>
        </header>

        <main class="flex-1 pt-20">
            <section class="relative w-full bg-gradient-to-br from-[#0E4B94]/5 to-[#2CD9C3]/5 py-20">
                <div class="container mx-auto px-4">
                    <div class="flex flex-col items-center text-center gap-8">
                        <h1 class="text-5xl md:text-6xl font-extrabold leading-tight tracking-tight max-w-4xl">
                            <span
                                class="bg-gradient-to-r from-[#2CD9C3] to-[#0E4B94] bg-clip-text text-transparent">Dein
                                Weg</span>
                            in die Branche.
                        </h1>
                        <p class="text-xl text-gray-600 dark:text-gray-300 max-w-2xl">
                            Bewirb dich für exklusive Events und unser Semesterprogramm.
                        </p>
                    </div>
                </div>
            </section>

            <section class="w-full bg-white dark:bg-background-dark py-20">
                <div class="container mx-auto px-4">
                    <div class="max-w-3xl mx-auto">
                        <div class="bg-[#F4F7F6] dark:bg-gray-800/50 rounded-xl p-8">
                            <h2 class="text-2xl font-bold text-black dark:text-white mb-6">Bewerbungsformular</h2>
                            <form id="application-form" class="space-y-6">

                                <!-- Dropdown -->
                                <div>
                                    <label for="program"
                                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Worauf
                                        bewirbst du dich?</label>
                                    <select id="program" name="program"
                                        class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-[#2CD9C3] focus:border-transparent transition-all">
                                        <option value="Sonderveranstaltung: Markel Insurance SE (22.01.2026)">
                                            Sonderveranstaltung: Markel Insurance SE (22.01.2026)</option>
                                        <option value="NextGen Future Talent Program (SoSe 2026)">NextGen Future Talent
                                            Program (SoSe 2026)</option>
                                    </select>
                                </div>

                                <!-- Personal Data -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label for="firstname"
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Vorname</label>
                                        <input type="text" id="firstname" name="firstname"
                                            class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-[#2CD9C3] focus:border-transparent transition-all"
                                            required />
                                    </div>
                                    <div>
                                        <label for="lastname"
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Nachname</label>
                                        <input type="text" id="lastname" name="lastname"
                                            class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-[#2CD9C3] focus:border-transparent transition-all"
                                            required />
                                    </div>
                                </div>

                                <div>
                                    <label for="email"
                                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">E-Mail-Adresse</label>
                                    <input type="email" id="email" name="email"
                                        class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-[#2CD9C3] focus:border-transparent transition-all"
                                        required />
                                </div>

                                <!-- File Uploads -->
                                <div>
                                    <label for="cv"
                                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Lebenslauf
                                        (CV) hochladen (PDF, max. 1 MB)</label>
                                    <input type="file" id="cv" name="cv" accept=".pdf"
                                        class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-[#2CD9C3] focus:border-transparent transition-all"
                                        required />
                                    <p id="cv-error" class="hidden text-red-500 text-sm mt-1"></p>
                                </div>

                                <div>
                                    <label for="transcript"
                                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Transcript
                                        of Records (und optional weitere Anhänge) (PDF, max. 3 MB)</label>
                                    <input type="file" id="transcript" name="transcript" accept=".pdf"
                                        class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-[#2CD9C3] focus:border-transparent transition-all"
                                        required />
                                    <p id="transcript-error" class="hidden text-red-500 text-sm mt-1"></p>
                                </div>
                                <p id="total-size-warning" class="hidden text-red-500 font-bold text-sm mt-1"></p>


                                <!-- Checkboxes -->
                                <div class="space-y-4 pt-4">
                                    <div class="flex items-start">
                                        <input id="commitment" name="commitment" type="checkbox"
                                            class="h-4 w-4 rounded border-gray-300 text-[#0E4B94] focus:ring-[#2CD9C3] mt-1"
                                            required>
                                        <label for="commitment" class="ml-3 text-sm text-gray-600 dark:text-gray-300">
                                            Ich habe verstanden, dass eine Teilnahme am Programm nur möglich ist, wenn
                                            ich an allen Workshops des Semesters teilnehme. Ein unentschuldigtes
                                            Nichterscheinen führt zum Ausschluss aus dem laufenden Semester.
                                        </label>
                                    </div>

                                    <div class="flex items-start">
                                        <input id="privacy" name="privacy" type="checkbox"
                                            class="h-4 w-4 rounded border-gray-300 text-[#0E4B94] focus:ring-[#2CD9C3] mt-1"
                                            required>
                                        <label for="privacy" class="ml-3 text-sm text-gray-600 dark:text-gray-300">
                                            Ich stimme der Verarbeitung meiner Daten gemäß der <a
                                                href="datenschutzerklarung.html" target="_blank"
                                                class="text-primary underline">Datenschutzerklärung</a> zu.
                                        </label>
                                    </div>

                                    <div class="flex items-start">
                                        <input id="media-release" name="media-release" type="checkbox"
                                            class="h-4 w-4 rounded border-gray-300 text-[#0E4B94] focus:ring-[#2CD9C3] mt-1"
                                            required>
                                        <label for="media-release"
                                            class="ml-3 text-sm text-gray-600 dark:text-gray-300">
                                            Ich nehme zur Kenntnis, dass im Rahmen der Veranstaltungen Foto- und
                                            Videoaufnahmen für die Öffentlichkeitsarbeit des Vereins erstellt werden.
                                        </label>
                                    </div>
                                </div>

                                <button type="submit"
                                    class="w-full flex h-14 items-center justify-center rounded-lg bg-gradient-to-r from-[#0E4B94] to-[#2CD9C3] px-10 text-lg font-bold text-white transition-transform hover:scale-105 shadow-lg">
                                    Bewerbung absenden
                                </button>
                                <p id="form-status" class="text-center mt-4 hidden"></p>
                            </form>

                            <script>
                                // File to Base64 Helper
                                const toBase64 = file => new Promise((resolve, reject) => {
                                    const reader = new FileReader();
                                    reader.readAsDataURL(file);
                                    reader.onload = () => resolve(reader.result.split(',')[1]); // remove data:application/pdf;base64, prefix
                                    reader.onerror = error => reject(error);
                                });

                                const cvInput = document.getElementById('cv');
                                const transcriptInput = document.getElementById('transcript');
                                const cvError = document.getElementById('cv-error');
                                const transcriptError = document.getElementById('transcript-error');
                                const totalSizeWarning = document.getElementById('total-size-warning');
                                const form = document.getElementById('application-form');

                                function validateFiles() {
                                    let valid = true;
                                    let totalSize = 0;

                                    // Reset errors
                                    cvError.classList.add('hidden');
                                    transcriptError.classList.add('hidden');
                                    totalSizeWarning.classList.add('hidden');

                                    // CV Validation (1MB)
                                    if (cvInput.files[0]) {
                                        if (cvInput.files[0].size > 1024 * 1024) {
                                            cvError.innerText = 'Die Datei ist zu groß (max. 1 MB).';
                                            cvError.classList.remove('hidden');
                                            valid = false;
                                        }
                                        totalSize += cvInput.files[0].size;
                                    }

                                    // Transcript Validation (3MB)
                                    if (transcriptInput.files[0]) {
                                        if (transcriptInput.files[0].size > 3 * 1024 * 1024) {
                                            transcriptError.innerText = 'Die Datei ist zu groß (max. 3 MB).';
                                            transcriptError.classList.remove('hidden');
                                            valid = false;
                                        }
                                        totalSize += transcriptInput.files[0].size;
                                    }

                                    // Total Size Warning (3.5MB safe limit)
                                    if (totalSize > 3.5 * 1024 * 1024) {
                                        totalSizeWarning.innerText = 'Die Gesamtgröße der Anhänge ist zu hoch für den Versand (Limit ca. 3.5 MB). Bitte verkleinern Sie die Dateien.';
                                        totalSizeWarning.classList.remove('hidden');
                                        valid = false; // Block submission strict to avoid API failure
                                    }

                                    return valid;
                                }

                                cvInput.addEventListener('change', validateFiles);
                                transcriptInput.addEventListener('change', validateFiles);

                                form.addEventListener('submit', async function (e) {
                                    e.preventDefault();

                                    if (!validateFiles()) {
                                        return;
                                    }

                                    const submitButton = form.querySelector('button[type="submit"]');
                                    const statusMessage = document.getElementById('form-status');
                                    const originalButtonText = submitButton.innerText;

                                    submitButton.disabled = true;
                                    submitButton.innerText = 'Sende Bewerbung... (Bitte warten)';
                                    submitButton.classList.add('opacity-50', 'cursor-not-allowed');
                                    statusMessage.classList.add('hidden');
                                    statusMessage.className = 'text-center mt-4 hidden';

                                    try {
                                        const cvFile = cvInput.files[0];
                                        const transcriptFile = transcriptInput.files[0];

                                        const formData = {
                                            program: document.getElementById('program').value,
                                            firstname: document.getElementById('firstname').value,
                                            lastname: document.getElementById('lastname').value,
                                            email: document.getElementById('email').value,
                                            cv: {
                                                filename: cvFile.name,
                                                content: await toBase64(cvFile)
                                            },
                                            transcript: {
                                                filename: transcriptFile.name,
                                                content: await toBase64(transcriptFile)
                                            },
                                            agreements: {
                                                commitment: document.getElementById('commitment').checked,
                                                privacy: document.getElementById('privacy').checked,
                                                media: document.getElementById('media-release').checked
                                            }
                                        };

                                        const response = await fetch('/api/apply', {
                                            method: 'POST',
                                            headers: {
                                                'Content-Type': 'application/json'
                                            },
                                            body: JSON.stringify(formData)
                                        });

                                        if (response.ok) {
                                            statusMessage.innerText = 'Erfolg! Deine Bewerbung wurde versendet.';
                                            statusMessage.classList.remove('hidden');
                                            statusMessage.classList.add('text-green-600', 'dark:text-green-400', 'font-medium');
                                            form.reset();
                                            form.classList.add('hidden'); // Hide form on success
                                        } else {
                                            const data = await response.json();
                                            throw new Error(data.error || 'Ein Fehler ist aufgetreten.');
                                        }
                                    } catch (error) {
                                        console.error('Error:', error);
                                        statusMessage.innerText = 'Fehler beim Senden: ' + error.message;
                                        statusMessage.classList.remove('hidden');
                                        statusMessage.classList.add('text-red-600', 'dark:text-red-400', 'font-medium');
                                    } finally {
                                        submitButton.disabled = false;
                                        submitButton.innerText = originalButtonText;
                                        submitButton.classList.remove('opacity-50', 'cursor-not-allowed');
                                    }
                                });
                            </script>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="w-full bg-gray-100 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800 py-8">
            <div class="container mx-auto px-4">
                <div class="flex flex-col md:flex-row items-center justify-between gap-4 max-w-6xl mx-auto">
                    <div class="text-gray-600 dark:text-gray-400 text-sm font-medium">
                        © 2025 NextGen Insurance Forum e.V.
                    </div>
                    <div class="flex items-center gap-6">
                        <a href="impressum.html"
                            class="text-gray-600 dark:text-gray-400 hover:text-[#0E4B94] dark:hover:text-[#2CD9C3] text-sm transition-colors">Impressum</a>
                        <a href="datenschutzerklarung.html"
                            class="text-gray-600 dark:text-gray-400 hover:text-[#0E4B94] dark:hover:text-[#2CD9C3] text-sm transition-colors">Datenschutz</a>
                    </div>
                    <div class="flex items-center gap-4">
                        <a href="mailto:info@nextgenforum.de"
                            class="text-gray-600 dark:text-gray-400 hover:text-[#0E4B94] dark:hover:text-[#2CD9C3] transition-colors flex items-center"
                            aria-label="Email">
                            <span class="material-symbols-outlined" style="font-size: 1.5rem;">mail</span>
                        </a>
                        <a href="https://www.linkedin.com/company/nextgen-forum" target="_blank"
                            rel="noopener noreferrer"
                            class="text-gray-600 dark:text-gray-400 hover:text-[#0E4B94] dark:hover:text-[#2CD9C3] transition-colors flex items-center"
                            aria-label="LinkedIn">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        document.querySelectorAll('.nav-link').forEach(link => {
            let rafId = null;
            link.addEventListener('mouseenter', (e) => {
                const rect = link.getBoundingClientRect();
                const x = ((e.clientX - rect.left) / rect.width) * 100;
                const y = ((e.clientY - rect.top) / rect.height) * 100;
                link.style.setProperty('--mouse-x', `${x}%`);
                link.style.setProperty('--mouse-y', `${y}%`);
            });
            link.addEventListener('mousemove', (e) => {
                if (rafId) return;
                rafId = requestAnimationFrame(() => {
                    const rect = link.getBoundingClientRect();
                    const x = ((e.clientX - rect.left) / rect.width) * 100;
                    const y = ((e.clientY - rect.top) / rect.height) * 100;
                    link.style.setProperty('--mouse-x', `${x}%`);
                    link.style.setProperty('--mouse-y', `${y}%`);
                    rafId = null;
                });
            });
        });
    </script>
</body>

</html>